Json Web Token에 대해서 배워볼게요. 일단 Json Web Token이 뭐냐면 JSON 객체로 안전하게 어떤 정보를 전송하기 위한 방식이에요. 이 정보는 디지털 서명이 되어 있으므로 신뢰할 수 있다는 거예요. 서명의 용도로 쓴대요. JWT는 HMAC알고리즘 또는 RSA를 사용을 한데요. ECDSA는 뭔지 모르셔도 됩니다. 
HMAC으로 쓸 때랑 RSA로 쓸 때의 방식이 조금 다르단 말이에요. 거기에 대해서 조금 이따가 한번 이해를 해볼게요. 그리고 JWT를 암호화하여 어떤 암호화 메시지를 보낼 수도 있지만 이 Json Web Token의 핵심은 서명된 Token에 중점을 둔다는 거예요. 
내가 만든 이 Json Web Token이 내가 쓴 게 맞아라는 서명의 용도로 사용을 하는 거예요. 그 서명된 토크는 그 안에 어떠한 정보가 있는데 클레임(요구 사항, 정보), 정보의 무결성을 확인할 수 있게 해줘요.

JSON Web Token는 언제 사용합니까? 이거는 이 문서를 읽어보는 것보다 실제로 우리가 사용을 하면서 이야기를 한번 해볼게요. 구조를 한번 볼 건데 한번 보면 X Y Z로 구성되요. 

![image](https://user-images.githubusercontent.com/79847020/145714773-2827ebcd-46b1-48a4-8e30-2b1d11690cdf.png)

X - 헤더
Y - 페이로드
Z - 시그니처(서명)

X이 부분을 헤더라고 하고요. Y 페이로드라고 합니다. Z 서명으로 이루어져있습니다. 

### 헤더

헤더는 일반적으로 JWT인 토큰 유형과 HMAC SHA256 또는 RSA와 같이 사용 중인 서명 알고리즘의 두 부분으로 구성된다.

```JAVA
{
  "alg": "HS256",
  "typ": "JWT"
}
```

alg 알고리즘은 "HS256"을 사용하고 typ 타입은 JWT 이다. 이 알고리즘 'HS256'이 뭔지도 조금 이따가 한번 살펴볼게요.
그리고 이 JSON은 Base64Url 인코딩되어 JWT의 첫 번째 부분을 형성한다. 그런 다음 Base64Url로 인코딩되어 있다고 하는데 Base64Uri는 암호화, 복호화 할 수 있는 암호화입니다.
이전 스프링 시큐리티 로그인 코드에서 사용한 암호화는 해싱이 되는 거기 때문에 복호화가 안됩니다. 비밀번호를 잊어버리면 비밀번호를 알아낼 수는 없고 초기화를 진행해야 합니다. 그게 해시입니다. 
이 Base64Url는 디코딩이 가능합니다. 암호화를 하고 나서 복호화를 할 수 있습니다. 

### 페이로드

토큰의 두 번째 부분은 클레임을 포함하는 페이로드입니다. 클레임은 3가지 등록된 클레임과 공개, 비공개 클레임 유형이 있습니다. 

등록된 클레임은 필수는 아니지만 권장되는 클레임 집합입니다. 그 중에는 iss(발행자), exp(만료시간), sub(대상), oud(청중) 등이 있다. 사실 안 넣어도 됩니다. 중요하지 않습니다. 

핵심을 이해하기 위해서는 페이로드에 무엇을 넣는지가 중요한데 우리는 Private 클레임을 넣어서 Private 클레임에 UserId 같은 정보를 넣어둘 것입니다. 그래서 이 JSON Web Token내 유저 정보에 필요한 어떤 공개돼도 되지만 그 유저인지를 특정할 수 있는 어떤 PrivateKey를 Private 클레임에 넣어줄 거예요. 





