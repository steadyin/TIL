
네 이번 시간에 스프링 시큐리티의 기본 API 그리고 필터들에 대한 학습을 하는 두 번째 섹션을 시작하도록 하겠습니다.
크게는 인증 API와 인가 API 두 가지로 나누어서 우리가 학습을 할 거고요. 먼저 인증 API에 대해서 살펴보도록 하겠습니다.
그러면 프로젝트를 구성하고요. 그리고 의존성을 추가하는 작업부터 진행하도록 하겠습니다.

네 그러면 제가 프로젝트를 하나 생성하도록 하죠.
jdk는 1.8 이상이면 되겠고요 next 하시고 그룹은 io.security 아티팩트는 basic security 디펜덴시는 SpringWeb만
선택을 해서 추가하도록 하겠습니다.
나머지는 그대로 가겠습니다.

이렇게 해서 BasicSecurity의 프로젝트가 생성이 되었습니다.

Springboot Starter Web 디펜던시가 추가되었고요

그러면 BasicSecurity 애플리케이션 메인 클래스가 생성이 되었습니다.
pom.xml에는 우리가 조금 전에 추가한 SpringBoot Starter Web 디페인던시가 추가되었어요.
일단 메인 클래스를 실행해보도록 하겠습니다.

그러면 스프링 부트는 메인 클래스를 실행하게 되면 Tomcat WAS가 기동이 됩니다.
Tomcat WAS를 스프링 부트가 내장을 하고 있어요. 그래서 8080 포트로 지금 서버가 기동이 되었죠.
9점대 버전을 사용하고 있습니다.
그러면 현재 우리가 루트 경로로 접속했을 때 간단한 문자열로 출력할 수 있도록 Controller 만들도록 하죠.
그래서 SecurityController로 생성을 하고요 @RestController로 타입을 하겠습니다.

@GetMapping해서 일단 루트로 갔을 때 루트 경로로 접속하게 되면 홈이라는 문자열이 찍히겠죠.
이렇게 해서 일단 서브를 다시 기동해서 루트 경로로 접속을 해보죠

네 그러면 8080 포트로 접속를 하면 이렇게 home 문자열이 찍히고 있습니 다.
그래서 서버가 정상적으로 기동이 되었고 화면에도 정상적으로 접속이 되죠.
그러면 지금 우리의 시스템은 정상적으로 서버가 기동하고 자원에는 접근이 가능하지만 가장 큰 문제점은 아무런 보안이 적용이 되지 않았다는 점이죠.

그래서 누구라도 우리 시스템에는 접근이 가능하고요 특별한 권한이 없어도 그리고 사용자마다 인증을 받지 않고도 원하는 자원에 바로 접근이 가능한 굉장히 보안에 취약한 구조입니다.
그러면 우리의 현재 시스템을 안정된 보안 보안이 적용된 시스템으로 변경을 하기 위해서 우리가 작업을 할 텐데요.

가장 먼저 해야 될 작업은 pom.xml의 Spring Security의 의존성을 추가하는 작업입니다.
그러면 의존성을 추가해 보죠. Spring Boot Starter Security 이렇게 디펜던시를 추가하시면 우리의 시스템은 그 즉시 보안이 적용된 시스템으로 바뀌게 됩니다.

우리가 조금 전에는 root 경로로 접속을 하게 되면 이렇게 접속이 가능했고 홈이라는 문자열도 출력이 됐죠.
근데 이제 우리가 이렇게 Spring Security 의존성을 추가한 이후에 다시금 서버를 기동해서 동일하게 루트 경로로 접속을 해보도록 하겠습니다.
그러면 어떤 변화가 발생했는지 확인해보도록 하겠습니다.
서버를 기동하면 먼저 차이점이 보이죠. 이렇게 Using generated security password가  제공이 되고 있습니다.
랜덤한 문자열로 이게 차이점이 있고요 예를 들어 제가 복사를 하겠습니다.
이 상태에서 제가 다시 루트 경로로 접속을 하면 그 이전에는 바로 접근이 가능했죠.
홈이라는 문자열도 찍혀 있고 그런데 지금 보시면 루트 경로로 접속이 안 되고요

로그인 페이지가 생성이 되어서 이렇게 화면이 출력되고 있습니다.
그리고 이 화면은 우리가 생성하지 않았죠.
우리가 지금 이 페이지를 만든 적이 없습니다.
이렇게 스프링 시큐리티가 로그인 페이지까지 제공을 하고 있어요.
그래서 현재는 우리가 루트 경로를 포함한 어떤 경로로 접근을 하기 위해서는 반드시 인증을 받아야만 그 자원의 접근이 가능한 구조로 바뀌었습니다.
기본적으로 제공하는 계정이 있는데요.
유저 네임은 유저고요 패스워드는 이렇게 콘솔에 출력한 기본적으로 제공하고 있죠.

이 패스워드를 제가 복사해서 로그인하면 이렇게 루트 경로로 지금 접속이 가능합니다.

이렇게 우리 시스템이 갑자기 의존성을 추구한 그 이후부터 인증을 받은 사용자만 지금 자원의 접근이 가능하고 인증을 받지 않으면 로그인 페이지가 떠서 인증을 받도록 그렇게 보안 기능이 작동하는 시스템으로 변경이 되었어요.

그러면 우리가 의존성을 추가했을 때 어떤 절차를 거쳐서 이렇게 보안 기능이 작동하게 됐는지 그 내용을 잠시 살펴보도록 하겠습니다.

그래서 Spring Security 의존성이 추가됐을 때 일어나는 일들입니다.

보시면 서브가 기동이 되면 스프링 시킬 뒤에 초기화 작업 및 보안 설정이 이루어집니다.
물론 우리가 하는 것이 아니죠.

Spring Security가 자동적으로 이러한 작업들이 서브가 기동될 때 초기에 작업 때 이루어지는 거예요.
이런 초기의 작업 및 보안 설정이 이루어졌기 때문에 우리가 별도의 설정이나 구현을 하지 않아도 기본적인 웹 보안 기능이 현재 우리의 시스템에 연동되어서 작동을 하고 있는 거예요.
그러면 어떠한 기본적인 웹 보안 기능이 지금 작동하고 있는지 살펴보면 첫 번째 모든 요청은 인증이 되어야 자원의 접근이 가능합니다.
그래서 조금 전에 우리가 홈 루트 경로로 지금 접근을 하려고 해도 인증이 되지 않으면 접근이 안 되죠. 그래서 인증이 되어야 접근이 가능한 구조로 바뀌었고요.
인증 방식은 이제 폼 로그인 방식과 httpBasic 로그인 방식이 있는데 두 개 제공하는데요.
지금 우리가 폼 로그인 방식으로 인증을 했죠.

이렇게 지금 기능이 동작하고 있고요 그리고 기본 로그인 페이지가 제공이 되었죠.
그리고 기본 계정도 한계가 제공이 되었습니다.
유저 네임은 user고요. 패스워드는 랜덤의 문자열로 우리가 로그인해서 인증을 받았죠.
이렇게 기본적인 웹 보안 기능이 Spring Security의 의존성을 추가할 때 제공이 되고 있습니다.
그리고 우리 시스템에 반영이 되어서 작동을 하고 있는 거죠.
그러면 이렇게 기본적인 웹 보안 기능은 작동을 하고 있지만 이 문제점이 있죠.
거기 보시면 계정을 추가할 때 지금은 기본적으로 하나의 계정만 제공합니다.
그렇기 때문에 우리가 계정을 추가해야 되고요. 권한도 추가해야 되겠죠.
인증을 받아도 어떤 자원에는 특정한 권한이 있어야 그 자원에 접근하도록 우리가 컨트롤 해야 되기 때문에 권한을 추가도 해야 되고 그리고 이런 계정이나 권한을 추가할 때도 db와 연동을 해서 또 구현을 할 수도 있어야 되죠.
근데 지금 시스템은 이런 기능을 도일한 추가적인 내용들을 우리가 할 수 있는 시스템은 아닙니다.
그래서 이런 문제점이 있고요. 
그래서 기본적인 보안 기능 외에도 우리 시스템에서 필요로 하는 더 세부적이고 추가적인 보완 기능이 필요합니다.
그래서 이 문제점을 어떻게 해결할 수 있을지 그 방안을 이제 우리가 찾아나가야 되겠죠.
네 그 내용은 우리가 다음 시간부터 이제 자세하게 살펴볼 내용이죠.
그러면 이번 시간에는 우리가 프로젝트를 구성을 했고요

그리고 Spring Security 의존성을 추가했습니다.
이런 방식으로 추가 했죠. 제가 이 내용은 잠시 스킵했네요.
이렇게 의존성을 추가했고요 그리고 Spring Security에 의존성을 추가했을 때 기본적으로 동작하는 내용들에 대해서 우리가 확인을 했습니다.
그러면 다음 시간에는 현재의 시스템을 좀 더 강화하고 또 개선하고 어떤 점을 보완해서 더 안정된 보안 시스템으로 우리가 발전시킬 수 있을지 그 내용에 대해서 살펴보는 시간을 갖도록 하겠습니다.
네 이번 시간은 여기까지 하도록 하겠습니다.
수고하셨습니다. 감사합니다.
